var Hashtable=function(){function hashObject(obj){var hashCode;if("string"==typeof obj)return obj;if(typeof obj.hashCode==FUNCTION)return hashCode=obj.hashCode(),"string"==typeof hashCode?hashCode:hashObject(hashCode);if(typeof obj.toString==FUNCTION)return obj.toString();try{return String(obj)}catch(ex){return Object.prototype.toString.call(obj)}}function equals_fixedValueHasEquals(fixedValue,variableValue){return fixedValue.equals(variableValue)}function equals_fixedValueNoEquals(fixedValue,variableValue){return typeof variableValue.equals==FUNCTION?variableValue.equals(fixedValue):fixedValue===variableValue}function createKeyValCheck(kvStr){return function(kv){if(null===kv)throw new Error("null is not a valid "+kvStr);if("undefined"==typeof kv)throw new Error(kvStr+" must not be undefined")}}function Bucket(hash,firstKey,firstValue,equalityFunction){this[0]=hash,this.entries=[],this.addEntry(firstKey,firstValue),null!==equalityFunction&&(this.getEqualityFunction=function(){return equalityFunction})}function createBucketSearcher(mode){return function(key){for(var entry,i=this.entries.length,equals=this.getEqualityFunction(key);i--;)if(entry=this.entries[i],equals(key,entry[0]))switch(mode){case EXISTENCE:return!0;case ENTRY:return entry;case ENTRY_INDEX_AND_VALUE:return[i,entry[1]]}return!1}}function createBucketLister(entryProperty){return function(aggregatedArr){for(var startIndex=aggregatedArr.length,i=0,len=this.entries.length;len>i;++i)aggregatedArr[startIndex+i]=this.entries[i][entryProperty]}}function searchBuckets(buckets,hash){for(var bucket,i=buckets.length;i--;)if(bucket=buckets[i],hash===bucket[0])return i;return null}function getBucketForHash(bucketsByHash,hash){var bucket=bucketsByHash[hash];return bucket&&bucket instanceof Bucket?bucket:null}function Hashtable(hashingFunctionParam,equalityFunctionParam){var that=this,buckets=[],bucketsByHash={},hashingFunction=typeof hashingFunctionParam==FUNCTION?hashingFunctionParam:hashObject,equalityFunction=typeof equalityFunctionParam==FUNCTION?equalityFunctionParam:null;this.put=function(key,value){checkKey(key),checkValue(value);var bucket,bucketEntry,hash=hashingFunction(key),oldValue=null;return bucket=getBucketForHash(bucketsByHash,hash),bucket?(bucketEntry=bucket.getEntryForKey(key),bucketEntry?(oldValue=bucketEntry[1],bucketEntry[1]=value):bucket.addEntry(key,value)):(bucket=new Bucket(hash,key,value,equalityFunction),buckets[buckets.length]=bucket,bucketsByHash[hash]=bucket),oldValue},this.get=function(key){checkKey(key);var hash=hashingFunction(key),bucket=getBucketForHash(bucketsByHash,hash);if(bucket){var bucketEntry=bucket.getEntryForKey(key);if(bucketEntry)return bucketEntry[1]}return null},this.containsKey=function(key){checkKey(key);var bucketKey=hashingFunction(key),bucket=getBucketForHash(bucketsByHash,bucketKey);return bucket?bucket.containsKey(key):!1},this.containsValue=function(value){checkValue(value);for(var i=buckets.length;i--;)if(buckets[i].containsValue(value))return!0;return!1},this.clear=function(){buckets.length=0,bucketsByHash={}},this.isEmpty=function(){return!buckets.length};var createBucketAggregator=function(bucketFuncName){return function(){for(var aggregated=[],i=buckets.length;i--;)buckets[i][bucketFuncName](aggregated);return aggregated}};this.keys=createBucketAggregator("keys"),this.values=createBucketAggregator("values"),this.entries=createBucketAggregator("getEntries"),this.remove=function(key){checkKey(key);var bucketIndex,hash=hashingFunction(key),oldValue=null,bucket=getBucketForHash(bucketsByHash,hash);return bucket&&(oldValue=bucket.removeEntryForKey(key),null!==oldValue&&(bucket.entries.length||(bucketIndex=searchBuckets(buckets,hash),arrayRemoveAt(buckets,bucketIndex),delete bucketsByHash[hash]))),oldValue},this.size=function(){for(var total=0,i=buckets.length;i--;)total+=buckets[i].entries.length;return total},this.each=function(callback){for(var entry,entries=that.entries(),i=entries.length;i--;)entry=entries[i],callback(entry[0],entry[1])},this.putAll=function(hashtable,conflictCallback){for(var entry,key,value,thisValue,entries=hashtable.entries(),i=entries.length,hasConflictCallback=typeof conflictCallback==FUNCTION;i--;)entry=entries[i],key=entry[0],value=entry[1],hasConflictCallback&&(thisValue=that.get(key))&&(value=conflictCallback(key,thisValue,value)),that.put(key,value)},this.clone=function(){var clone=new Hashtable(hashingFunctionParam,equalityFunctionParam);return clone.putAll(that),clone}}var FUNCTION="function",arrayRemoveAt=typeof Array.prototype.splice==FUNCTION?function(arr,idx){arr.splice(idx,1)}:function(arr,idx){var itemsAfterDeleted,i,len;if(idx===arr.length-1)arr.length=idx;else for(itemsAfterDeleted=arr.slice(idx+1),arr.length=idx,i=0,len=itemsAfterDeleted.length;len>i;++i)arr[idx+i]=itemsAfterDeleted[i]},checkKey=createKeyValCheck("key"),checkValue=createKeyValCheck("value"),EXISTENCE=0,ENTRY=1,ENTRY_INDEX_AND_VALUE=2;return Bucket.prototype={getEqualityFunction:function(searchValue){return typeof searchValue.equals==FUNCTION?equals_fixedValueHasEquals:equals_fixedValueNoEquals},getEntryForKey:createBucketSearcher(ENTRY),getEntryAndIndexForKey:createBucketSearcher(ENTRY_INDEX_AND_VALUE),removeEntryForKey:function(key){var result=this.getEntryAndIndexForKey(key);return result?(arrayRemoveAt(this.entries,result[0]),result[1]):null},addEntry:function(key,value){this.entries[this.entries.length]=[key,value]},keys:createBucketLister(0),values:createBucketLister(1),getEntries:function(entries){for(var startIndex=entries.length,i=0,len=this.entries.length;len>i;++i)entries[startIndex+i]=this.entries[i].slice(0)},containsKey:createBucketSearcher(EXISTENCE),containsValue:function(value){for(var i=this.entries.length;i--;)if(value===this.entries[i][1])return!0;return!1}},Hashtable}();!function($){$.baseClass=function(obj){return obj=$(obj),obj.get(0).className.match(/([^ ]+)/)[1]},$.fn.addDependClass=function(className,delimiter){var options={delimiter:delimiter?delimiter:"-"};return this.each(function(){var baseClass=$.baseClass(this);baseClass&&$(this).addClass(baseClass+options.delimiter+className)})},$.fn.removeDependClass=function(className,delimiter){var options={delimiter:delimiter?delimiter:"-"};return this.each(function(){var baseClass=$.baseClass(this);baseClass&&$(this).removeClass(baseClass+options.delimiter+className)})},$.fn.toggleDependClass=function(className,delimiter){var options={delimiter:delimiter?delimiter:"-"};return this.each(function(){var baseClass=$.baseClass(this);baseClass&&($(this).is("."+baseClass+options.delimiter+className)?$(this).removeClass(baseClass+options.delimiter+className):$(this).addClass(baseClass+options.delimiter+className))})}}(jQuery),function(jQuery){function FormatData(dec,group,neg){this.dec=dec,this.group=group,this.neg=neg}function init(){for(var localeGroupIdx=0;localeGroupIdx<nfAllLocales.length;localeGroupIdx++){localeGroup=nfAllLocales[localeGroupIdx];for(var i=0;i<localeGroup.length;i++)nfLocales.put(localeGroup[i],localeGroupIdx)}}function formatCodes(locale,isFullLocale){0==nfLocales.size()&&init();var dec=".",group=",",neg="-";0==isFullLocale&&(-1!=locale.indexOf("_")?locale=locale.split("_")[1].toLowerCase():-1!=locale.indexOf("-")&&(locale=locale.split("-")[1].toLowerCase()));var codesIndex=nfLocales.get(locale);if(codesIndex){var codes=nfLocaleFormatting[codesIndex];codes&&(dec=codes[0],group=codes[1])}return new FormatData(dec,group,neg)}var nfLocales=new Hashtable,nfLocalesLikeUS=["ae","au","ca","cn","eg","gb","hk","il","in","jp","sk","th","tw","us"],nfLocalesLikeDE=["at","br","de","dk","es","gr","it","nl","pt","tr","vn"],nfLocalesLikeFR=["cz","fi","fr","ru","se","pl"],nfLocalesLikeCH=["ch"],nfLocaleFormatting=[[".",","],[",","."],[","," "],[".","'"]],nfAllLocales=[nfLocalesLikeUS,nfLocalesLikeDE,nfLocalesLikeFR,nfLocalesLikeCH];jQuery.fn.formatNumber=function(options,writeBack,giveReturnValue){return this.each(function(){null==writeBack&&(writeBack=!0),null==giveReturnValue&&(giveReturnValue=!0);var text;text=new String(jQuery(this).is(":input")?jQuery(this).val():jQuery(this).text());var returnString=jQuery.formatNumber(text,options);return writeBack&&(jQuery(this).is(":input")?jQuery(this).val(returnString):jQuery(this).text(returnString)),giveReturnValue?returnString:void 0})},jQuery.formatNumber=function(numberString,options){for(var options=jQuery.extend({},jQuery.fn.formatNumber.defaults,options),formatData=formatCodes(options.locale.toLowerCase(),options.isFullLocale),validFormat=(formatData.dec,formatData.group,formatData.neg,"0#-,."),prefix="",negativeInFront=!1,i=0;i<options.format.length;i++){if(-1!=validFormat.indexOf(options.format.charAt(i))){if(0==i&&"-"==options.format.charAt(i)){negativeInFront=!0;continue}break}prefix+=options.format.charAt(i)}for(var suffix="",i=options.format.length-1;i>=0&&-1==validFormat.indexOf(options.format.charAt(i));i--)suffix=options.format.charAt(i)+suffix;options.format=options.format.substring(prefix.length),options.format=options.format.substring(0,options.format.length-suffix.length);var number=new Number(numberString);return jQuery._formatNumber(number,options,suffix,prefix,negativeInFront)},jQuery._formatNumber=function(number,options,suffix,prefix,negativeInFront){var options=jQuery.extend({},jQuery.fn.formatNumber.defaults,options),formatData=formatCodes(options.locale.toLowerCase(),options.isFullLocale),dec=formatData.dec,group=formatData.group,neg=formatData.neg,forcedToZero=!1;if(isNaN(number)){if(1!=options.nanForceZero)return null;number=0,forcedToZero=!0}"%"==suffix&&(number=100*number);var returnString="";if(options.format.indexOf(".")>-1){var decimalPortion=dec,decimalFormat=options.format.substring(options.format.lastIndexOf(".")+1);if(1==options.round)number=new Number(number.toFixed(decimalFormat.length));else{var numStr=number.toString();numStr=numStr.substring(0,numStr.lastIndexOf(".")+decimalFormat.length+1),number=new Number(numStr)}var decimalValue=number%1,decimalString=new String(decimalValue.toFixed(decimalFormat.length));decimalString=decimalString.substring(decimalString.lastIndexOf(".")+1);for(var i=0;i<decimalFormat.length;i++)if("#"!=decimalFormat.charAt(i)||"0"==decimalString.charAt(i)){if("#"==decimalFormat.charAt(i)&&"0"==decimalString.charAt(i)){var notParsed=decimalString.substring(i);if(notParsed.match("[1-9]")){decimalPortion+=decimalString.charAt(i);continue}break}"0"==decimalFormat.charAt(i)&&(decimalPortion+=decimalString.charAt(i))}else decimalPortion+=decimalString.charAt(i);returnString+=decimalPortion}else number=Math.round(number);var ones=Math.floor(number);0>number&&(ones=Math.ceil(number));var onesFormat="";onesFormat=-1==options.format.indexOf(".")?options.format:options.format.substring(0,options.format.indexOf("."));var onePortion="";if(0!=ones||"#"!=onesFormat.substr(onesFormat.length-1)||forcedToZero){var oneText=new String(Math.abs(ones)),groupLength=9999;-1!=onesFormat.lastIndexOf(",")&&(groupLength=onesFormat.length-onesFormat.lastIndexOf(",")-1);for(var groupCount=0,i=oneText.length-1;i>-1;i--)onePortion=oneText.charAt(i)+onePortion,groupCount++,groupCount==groupLength&&0!=i&&(onePortion=group+onePortion,groupCount=0);if(onesFormat.length>onePortion.length){var padStart=onesFormat.indexOf("0");if(-1!=padStart)for(var padLen=onesFormat.length-padStart,pos=onesFormat.length-onePortion.length-1;onePortion.length<padLen;){var padChar=onesFormat.charAt(pos);","==padChar&&(padChar=group),onePortion=padChar+onePortion,pos--}}}return onePortion||-1===onesFormat.indexOf("0",onesFormat.length-1)||(onePortion="0"),returnString=onePortion+returnString,0>number&&negativeInFront&&prefix.length>0?prefix=neg+prefix:0>number&&(returnString=neg+returnString),options.decimalSeparatorAlwaysShown||returnString.lastIndexOf(dec)==returnString.length-1&&(returnString=returnString.substring(0,returnString.length-1)),returnString=prefix+returnString+suffix},jQuery.fn.parseNumber=function(options,writeBack,giveReturnValue){null==writeBack&&(writeBack=!0),null==giveReturnValue&&(giveReturnValue=!0);var text;text=new String(jQuery(this).is(":input")?jQuery(this).val():jQuery(this).text());var number=jQuery.parseNumber(text,options);return number&&(writeBack&&(jQuery(this).is(":input")?jQuery(this).val(number.toString()):jQuery(this).text(number.toString())),giveReturnValue)?number:void 0},jQuery.parseNumber=function(numberString,options){for(var options=jQuery.extend({},jQuery.fn.parseNumber.defaults,options),formatData=formatCodes(options.locale.toLowerCase(),options.isFullLocale),dec=formatData.dec,group=formatData.group,neg=formatData.neg,valid="1234567890.-";numberString.indexOf(group)>-1;)numberString=numberString.replace(group,"");numberString=numberString.replace(dec,".").replace(neg,"-");var validText="",hasPercent=!1;("%"==numberString.charAt(numberString.length-1)||1==options.isPercentage)&&(hasPercent=!0);for(var i=0;i<numberString.length;i++)valid.indexOf(numberString.charAt(i))>-1&&(validText+=numberString.charAt(i));var number=new Number(validText);if(hasPercent){number/=100;var decimalPos=validText.indexOf(".");if(-1!=decimalPos){var decimalPoints=validText.length-decimalPos-1;number=number.toFixed(decimalPoints+2)}else number=number.toFixed(validText.length-1)}return number},jQuery.fn.parseNumber.defaults={locale:"us",decimalSeparatorAlwaysShown:!1,isPercentage:!1,isFullLocale:!1},jQuery.fn.formatNumber.defaults={format:"#,###.00",locale:"us",decimalSeparatorAlwaysShown:!1,nanForceZero:!0,round:!0,isFullLocale:!1},Number.prototype.toFixed=function(precision){return jQuery._roundNumber(this,precision)},jQuery._roundNumber=function(number,decimalPlaces){var power=Math.pow(10,decimalPlaces||0),value=String(Math.round(number*power)/power);if(decimalPlaces>0){var dp=value.indexOf(".");for(-1==dp?(value+=".",dp=0):dp=value.length-(dp+1);decimalPlaces>dp;)value+="0",dp++}return value}}(jQuery);var __extends=this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);__.prototype=b.prototype,d.prototype=new __},SliderValueLabel=function(_super){function SliderValueLabel($element){_super.call(this,$element),this.$value=$element.find("span")}return __extends(SliderValueLabel,_super),SliderValueLabel.prototype.setValue=function(str){this.$value.html(str)},SliderValueLabel}(SliderBaseLabel),SliderTemplate=function(){function SliderTemplate(template){this.cache=this.createTemplateFn(template)}return SliderTemplate.prototype.render=function(data){return this.cache(data)},SliderTemplate.prototype.createTemplateFn=function(template){return new Function("data","var p=[],print=function(){p.push.apply(p,arguments);};with(data){p.push('"+template.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');")},SliderTemplate}(),SliderDraggable=function(){function SliderDraggable(pointer,uid,slider){this.defaultIs={drag:!1,clicked:!1,toclick:!0,mouseup:!1},this.init(pointer),this.onInit(pointer,uid,slider)}return SliderDraggable.prototype.init=function(pointer){arguments.length>0&&(this.pointer=jQuery(pointer),this.outer=jQuery(".draggable-outer"));var offset=this.getPointerOffset();this.is=jQuery.extend(this.is,this.defaultIs),this.d={left:offset.left,top:offset.top,width:this.pointer.width(),height:this.pointer.height()},this.events={down:"touch",move:"drag",up:"release",click:"tap"},this.setupEvents()},SliderDraggable.prototype.setupEvents=function(){var _this=this;this.bind(jQuery(document),SliderDraggable.EVENT_MOVE,function(event){_this.is.drag&&(event.gesture.preventDefault(),event.gesture.stopPropagation(),_this.mouseMove(event))}),this.bind(jQuery(document),SliderDraggable.EVENT_DOWN,function(event){_this.is.drag&&(event.gesture.preventDefault(),event.gesture.stopPropagation())}),this.bind(this.pointer,SliderDraggable.EVENT_MOVE,function(event){_this.is.drag&&(event.gesture.preventDefault(),event.gesture.stopPropagation(),_this.mouseMove(event))}),this.bind(this.pointer,SliderDraggable.EVENT_DOWN,function(event){return _this.mouseDown(event),!1}),this.bind(this.pointer,SliderDraggable.EVENT_UP,function(event){_this.mouseUp(event)}),this.bind(this.pointer,SliderDraggable.EVENT_CLICK,function(){return _this.is.clicked=!0,_this.is.toclick?!0:(_this.is.toclick=!0,!1)})},SliderDraggable.prototype.getPageCoords=function(event){var touchList=event.gesture.touches;return{x:touchList[0].pageX,y:touchList[0].pageY}},SliderDraggable.prototype.getPointerOffset=function(){return this.pointer.offset()},SliderDraggable.prototype.unbind=function(){for(var eventType in this.events){var namespacedEvent=this.events[eventType];jQuery(document).hammer().off(namespacedEvent),this.pointer.hammer().off(namespacedEvent)}},SliderDraggable.prototype.bind=function(element,eventType,callback){var namespacedEvent=this.events[eventType];Hammer(element.get(0)).on(namespacedEvent,callback)},SliderDraggable.prototype.mouseDown=function(event){this.is.drag=!0,this.is.mouseup=this.is.clicked=!1;var offset=this.getPointerOffset(),coords=this.getPageCoords(event);this.cursorX=coords.x-offset.left,this.cursorY=coords.y-offset.top,this.d=jQuery.extend(this.d,{left:offset.left,top:offset.top,width:this.pointer.width(),height:this.pointer.height()}),this.outer.length>0&&this.outer.css({height:Math.max(this.outer.height(),jQuery(document.body).height()),overflow:"hidden"}),this.onMouseDown(event)},SliderDraggable.prototype.mouseMove=function(event){this.is.toclick=!1;var coords=this.getPageCoords(event);this.onMouseMove(event,coords.x-this.cursorX,coords.y-this.cursorY)},SliderDraggable.prototype.mouseUp=function(event){this.is.drag&&(this.is.drag=!1,this.outer.css(this.outer.length>0&&navigator.userAgent.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/i.test(navigator.userAgent)?{overflow:"hidden"}:{overflow:"visible"}),this.onMouseUp(event))},SliderDraggable.prototype.onInit=function(){},SliderDraggable.prototype.onMouseDown=function(){this.pointer.css({position:"absolute"})},SliderDraggable.prototype.onMouseMove=function(event,x,y){"undefined"==typeof x&&(x=null),"undefined"==typeof y&&(y=null)},SliderDraggable.prototype.onMouseUp=function(){},SliderDraggable.prototype.destroy=function(){this.unbind(),this.pointer.remove()},SliderDraggable.EVENT_NAMESPACE=".sliderDraggable",SliderDraggable.EVENT_CLICK="click",SliderDraggable.EVENT_UP="up",SliderDraggable.EVENT_MOVE="move",SliderDraggable.EVENT_DOWN="down",SliderDraggable}(),__extends=this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);__.prototype=b.prototype,d.prototype=new __},SliderPointer=function(_super){function SliderPointer(){_super.apply(this,arguments)}return __extends(SliderPointer,_super),SliderPointer.prototype.onInit=function(pointer,id,slider){_super.prototype.onInit.call(this,pointer,id,slider),this.uid=id,this.parent=slider,this.value={prc:null,origin:null},this.settings=this.parent.settings},SliderPointer.prototype.onMouseDown=function(event){_super.prototype.onMouseDown.call(this,event),this._parent={offset:this.parent.$el.offset(),width:this.parent.$el.width()},this.pointer.addDependClass("hover"),this.setIndexOver()},SliderPointer.prototype.onMouseMove=function(event){_super.prototype.onMouseMove.call(this,event),this._set(this.calc(this.getPageCoords(event).x)),this.parent.setValueElementPosition(),this.parent.redrawLabels(this)},SliderPointer.prototype.isDistanceViolation=function(){var distance=this.settings.distance,another=this.getAdjacentPointer();return!this.settings.single&&this.value&&another&&another.value&&(distance.min&&(this.uid===Slider.POINTER_FROM&&this.value.origin+distance.min>=another.value.origin||this.uid===Slider.POINTER_TO&&this.value.origin-distance.min<=another.value.origin)||distance.max&&(this.uid===Slider.POINTER_FROM&&another.value.origin+distance.max>=this.value.origin||this.uid===Slider.POINTER_TO&&another.value.origin-distance.max<=this.value.origin))},SliderPointer.prototype.onMouseUp=function(event){_super.prototype.onMouseUp.call(this,event),!this.settings.single&&this.isDistanceViolation()&&this.parent.setValueElementPosition(),jQuery.isFunction(this.settings.onStateChange)&&this.settings.onStateChange.call(this.parent,this.parent.getValue()),this.pointer.removeDependClass("hover")},SliderPointer.prototype.setIndexOver=function(){this.parent.setPointerIndex(1),this.index(2)},SliderPointer.prototype.index=function(i){this.pointer.css({zIndex:i})},SliderPointer.prototype.limits=function(x){return this.parent.limits(x,this)},SliderPointer.prototype.calc=function(coords){return this.limits(100*(coords-this._parent.offset.left)/this._parent.width)},SliderPointer.prototype.set=function(value,optOrigin){"undefined"==typeof optOrigin&&(optOrigin=!1),this.value.origin=this.parent.round(value),this._set(this.parent.valueToPrc(value,this),optOrigin)},SliderPointer.prototype.get=function(){return this.value},SliderPointer.prototype._set=function(prc,optOrigin){"undefined"==typeof optOrigin&&(optOrigin=!1),optOrigin||(this.value.origin=this.parent.prcToValue(prc));var another=this.getAdjacentPointer(),distance=this.settings.distance;if(this.isDistanceViolation()){var originValue=this.get().origin,anotherOriginValue=another.get().origin;switch(this.uid){case Slider.POINTER_FROM:Boolean(distance.max)&&originValue<=anotherOriginValue-distance.max?this.value.origin=anotherOriginValue-distance.max:Boolean(distance.min)&&originValue+distance.min>=anotherOriginValue&&(this.value.origin=this.clamp(anotherOriginValue-distance.min,this.settings.from,this.settings.to));break;case Slider.POINTER_TO:Boolean(distance.max)&&originValue>=anotherOriginValue+distance.max?this.value.origin=anotherOriginValue+distance.max:Boolean(distance.min)&&originValue-distance.min<=anotherOriginValue&&(this.value.origin=this.clamp(anotherOriginValue+distance.min,this.settings.from,this.settings.to))}prc=this.parent.valueToPrc(this.value.origin,this)}this.value.prc=prc,this.pointer.css({left:prc+"%"}),this.parent.update()},SliderPointer.prototype.clamp=function(delta,min,max){return delta>max?max:min>delta?min:delta},SliderPointer.prototype.getAdjacentPointer=function(){return this.parent.getPointers()[1-this.uid]},SliderPointer.prototype.hasSameOrigin=function(pointer){return this.value.prc==pointer.get().prc},SliderPointer}(SliderDraggable),Slider=function(){function Slider(inputNode,settings){if("undefined"==typeof settings&&(settings={}),this.defaultSettings={from:1,to:10,step:1,smooth:!0,limits:!0,round:0,format:{format:"#,##0.##"},value:"5;7",dimension:"",distance:{min:null,max:null}},this.template=new SliderTemplate('<span class="<%=className%>"><div class="<%=className%>-bg"><i class="l"></i><i class="f"></i><i class="r"></i><i class="v"></i></div><div class="<%=className%>-pointer"></div><div class="<%=className%>-pointer <%=className%>-pointer-to"></div><div class="<%=className%>-label"><span><%=settings.from%></span></div><div class="<%=className%>-label <%=className%>-label-to"><span><%=settings.to%></span><%=settings.dimension%></div><div class="<%=className%>-value"><span></span><%=settings.dimension%></div><div class="<%=className%>-value <%=className%>-value-to"><span></span><%=settings.dimension%></div><div class="<%=className%>-scale"><%=scale%></div></span>'),this.is={init:!1},this.settings=jQuery.extend(this.defaultSettings,settings),this.$input=jQuery(inputNode).hide(),"INPUT"!==this.$input.prop("tagName"))throw"jquery.slider: Slider must only be applied to INPUT elements.";if(this.settings.interval=this.settings.to-this.settings.from,this.settings.value=this.$input.val(),null===this.settings.value||void 0===this.settings.value)throw"jquery.slider: INPUT element does not have a value.";this.settings.calculate&&jQuery.isFunction(this.settings.calculate)&&(this.calculate=this.settings.calculate),this.create()}return Slider.prototype.create=function(){var _this=this;this.$el=jQuery(this.template.render({className:Slider.CLASSNAME,settings:{from:this.calculate(this.settings.from),to:this.calculate(this.settings.to),dimension:this.settings.dimension},scale:this.generateScale()})),this.$input.after(this.$el),this.drawScale();var values=this.settings.value.split(";");1==values.length&&(this.settings.single=!0,this.$el.addDependClass("single")),this.settings.limits||this.$el.addDependClass("limitless"),this.settings.skin&&this.setSkin(this.settings.skin.toString()),this.sizes={domWidth:this.$el.width(),domOffset:this.$el.offset()};var valueLabels=this.$el.find(Slider.SELECTOR+"value"),limitLabels=this.$el.find(Slider.SELECTOR+"label");this.components={pointers:[],labels:[new SliderValueLabel(valueLabels.not(Slider.SELECTOR+"value-to")),new SliderValueLabel(valueLabels.filter(Slider.SELECTOR+"value-to"))],limits:[new SliderLimitLabel(limitLabels.not(Slider.SELECTOR+"label-to")),new SliderLimitLabel(limitLabels.filter(Slider.SELECTOR+"label-to"))]},this.$el.find(Slider.SELECTOR+"pointer").each(function(i,element){var value=Number(values[i]),prev=Number(values[i-1]);if(!isNaN(value)){!isNaN(prev)&&prev>value&&(value=prev);var pointer=new SliderPointer(element,i,_this);value=value<_this.settings.from?_this.settings.from:value,value=value>_this.settings.to?_this.settings.to:value,pointer.set(value,!0),_this.components.pointers[i]=pointer}}),this.components.value=this.$el.find(".v"),this.is.init=!0,jQuery.each(this.components.pointers,function(i,pointer){_this.settings.single||_this.ensurePointerIndex(pointer),_this.redraw(pointer)}),jQuery(window).resize(function(){_this.onResize()})},Slider.prototype.ensurePointerIndex=function(pointer){var otherPointer=pointer.getAdjacentPointer();pointer.hasSameOrigin(otherPointer)&&(pointer.uid==Slider.POINTER_FROM&&pointer.get().origin==this.settings.from?otherPointer.setIndexOver():pointer.uid==Slider.POINTER_TO&&pointer.get().origin==this.settings.to&&otherPointer.setIndexOver())},Slider.prototype.onStateChange=function(value){return jQuery.isFunction(this.settings.onStateChange)?this.settings.onStateChange.apply(this,value):!0},Slider.prototype.disableSlider=function(){this.$el.addClass("disabled")},Slider.prototype.enableSlider=function(){this.$el.removeClass("disabled")},Slider.prototype.update=function(){this.onResize(),this.drawScale()},Slider.prototype.setSkin=function(skinName){this.settings.skin&&this.$el.removeDependClass(this.settings.skin,"_"),this.$el.addDependClass(this.settings.skin=skinName,"_")},Slider.prototype.setPointerIndex=function(index){jQuery.each(this.getPointers(),function(i,pointer){pointer.index(index)})},Slider.prototype.getPointers=function(){return this.components.pointers},Slider.prototype.generateScale=function(){if(!this.settings.scale)return"";for(var str="",scale=this.settings.scale,prc=Math.min(Math.max(0,Math.round(100/(scale.length-1)*1e4)/1e4),100),i=0;i<scale.length;i++)str+='<span style="left: '+i*prc+'%">'+("|"!=scale[i]?"<ins>"+scale[i]+"</ins>":"")+"</span>";return str},Slider.prototype.drawScale=function(){this.$el.find(Slider.SELECTOR+"scale span ins").each(function(){jQuery(this).css({marginLeft:-jQuery(this).outerWidth()/2})})},Slider.prototype.onResize=function(){var _this=this;this.sizes={domWidth:this.$el.width(),domOffset:this.$el.offset()},jQuery.each(this.components.pointers,function(i,pointer){_this.redraw(pointer)})},Slider.prototype.limits=function(x,pointer){if(!this.settings.smooth){var step=100*this.settings.step/this.settings.interval;x=Math.round(x/step)*step}var another=this.components.pointers[1-pointer.uid];return another&&pointer.uid&&x<another.value.prc&&(x=another.value.prc),another&&!pointer.uid&&x>another.value.prc&&(x=another.value.prc),0>x&&(x=0),x>100&&(x=100),Math.round(10*x)/10},Slider.prototype.redraw=function(pointer){this.is.init&&(this.setValue(),this.setValueElementPosition(),this.redrawLabels(pointer))},Slider.prototype.setValueElementPosition=function(){if(2==this.components.pointers.length){var cssProps={left:this.components.pointers[Slider.POINTER_FROM].value.prc+"%",width:this.components.pointers[Slider.POINTER_TO].value.prc-this.components.pointers[0].value.prc+"%"};this.components.value.css(cssProps)}},Slider.prototype.redrawLabels=function(pointer){var label=this.components.labels[pointer.uid];label.setValue(this.calculate(pointer.value.origin));var prc=pointer.value.prc,sizes={label:label.outerWidth(),right:!1,border:prc*this.sizes.domWidth/100};if(!this.settings.single){var another=pointer.getAdjacentPointer(),anotherLabel=this.components.labels[another.uid];switch(pointer.uid){case Slider.POINTER_FROM:sizes.border+sizes.label/2>anotherLabel.offset().left-this.sizes.domOffset.left?(anotherLabel.css({visibility:"hidden"}),anotherLabel.setValue(this.calculate(another.value.origin)),label.css({visibility:"visible"}),prc=(another.value.prc-prc)/2+prc,another.value.prc!=pointer.value.prc&&(label.setValue(this.calculate(pointer.value.origin)+"&nbsp;&ndash;&nbsp;"+this.calculate(another.value.origin)),sizes.label=label.outerWidth(),sizes.border=prc*this.sizes.domWidth/100)):anotherLabel.css({visibility:"visible"});break;case Slider.POINTER_TO:sizes.border-sizes.label/2<anotherLabel.offset().left-this.sizes.domOffset.left+anotherLabel.outerWidth()?(anotherLabel.css({visibility:"hidden"}),anotherLabel.setValue(this.calculate(another.value.origin)),label.css({visibility:"visible"}),prc=(prc-another.value.prc)/2+another.value.prc,another.value.prc!=pointer.value.prc&&(label.setValue(this.calculate(another.value.origin)+"&nbsp;&ndash;&nbsp;"+this.calculate(pointer.value.origin)),sizes.label=label.outerWidth(),sizes.border=prc*this.sizes.domWidth/100)):anotherLabel.css({visibility:"visible"})}}this.setPosition(label,sizes,prc),anotherLabel&&(sizes={label:anotherLabel.outerWidth(),right:!1,border:another.value.prc*this.sizes.domWidth/100},this.setPosition(anotherLabel,sizes,another.value.prc)),this.redrawLimits()},Slider.prototype.redrawLimits=function(){if(this.settings.limits){var limits=[!0,!0];for(var key in this.components.pointers)if(!this.settings.single||0==key){if(!this.components.pointers.hasOwnProperty(key))continue;var pointer=this.components.pointers[key],label=this.components.labels[pointer.uid],labelLeft=label.offset().left-this.sizes.domOffset.left;labelLeft<this.components.limits[Slider.POINTER_FROM].outerWidth()&&(limits[0]=!1),labelLeft+label.outerWidth()>this.sizes.domWidth-this.components.limits[Slider.POINTER_TO].outerWidth()&&(limits[1]=!1)}for(var i=0;i<limits.length;i++)limits[i]?this.components.limits[i].fadeIn("fast"):this.components.limits[i].fadeOut("fast")}},Slider.prototype.setPosition=function(label,sizes,prc){sizes.margin=-sizes.label/2;var labelLeft=sizes.border+sizes.margin;0>labelLeft&&(sizes.margin-=labelLeft),sizes.border+sizes.label/2>this.sizes.domWidth?(sizes.margin=0,sizes.right=!0):sizes.right=!1;var cssProps={left:prc+"%",marginLeft:sizes.margin,right:"auto"};return label.css(cssProps),sizes.right&&label.css({left:"auto",right:0}),sizes},Slider.prototype.setValue=function(){var value=this.getValue();this.$input.val(value),this.onStateChange(value)},Slider.prototype.getValue=function(){var _this=this;if(!this.is.init)return!1;var value="";return jQuery.each(this.components.pointers,function(i,pointer){void 0==pointer.value.prc||isNaN(pointer.value.prc)||(value+=(i>0?";":"")+_this.prcToValue(pointer.value.prc))}),value},Slider.prototype.getPrcValue=function(){if(!this.is.init)return!1;var value="";return jQuery.each(this.components.pointers,function(i,pointer){void 0==pointer.value.prc||isNaN(pointer.value.prc)||(value+=(i>0?";":"")+pointer.value.prc)}),value},Slider.prototype.prcToValue=function(prc){if(this.settings.hetrogeneity&&this.settings.hetrogeneity.length>0)for(var value,heterogeneity=this.settings.hetrogeneity,start=0,from=this.settings.from,i=0;i<=heterogeneity.length;i++){var v;
v=heterogeneity[i]?heterogeneity[i].split("/"):[100,this.settings.to],v[0]=Number(v[0]),v[1]=Number(v[1]),prc>=start&&prc<=v[0]&&(value=from+(prc-start)*(v[1]-from)/(v[0]-start)),start=v[0],from=v[1]}else value=this.settings.from+prc*this.settings.interval/100;return this.round(value)},Slider.prototype.valueToPrc=function(value,pointer){var prc;if(this.settings.hetrogeneity&&this.settings.hetrogeneity.length>0)for(var v,hetrogeneity=this.settings.hetrogeneity,start=0,from=this.settings.from,i=0;i<=hetrogeneity.length;i++)v=hetrogeneity[i]?hetrogeneity[i].split("/"):[100,this.settings.to],v[0]=Number(v[0]),v[1]=Number(v[1]),value>=from&&value<=v[1]&&(prc=pointer.limits(start+(value-from)*(v[0]-start)/(v[1]-from))),start=v[0],from=v[1];else prc=pointer.limits(100*(value-this.settings.from)/this.settings.interval);return prc},Slider.prototype.round=function(value){return value=Math.round(value/this.settings.step)*this.settings.step,value=this.settings.round?Math.round(value*Math.pow(10,this.settings.round))/Math.pow(10,this.settings.round):Math.round(value)},Slider.prototype.calculate=function(value){return value=value.toString().replace(/,/gi,".").replace(/ /gi,""),jQuery.formatNumber?jQuery.formatNumber(Number(value),this.settings.format||{}).replace(/-/gi,"&minus;"):Number(value).toString()},Slider.prototype.destroy=function(){jQuery.each(this.components.pointers,function(i,sliderPointer){sliderPointer.destroy()}),jQuery.each(this.components.labels,function(i,sliderValueLabel){sliderValueLabel.destroy()}),jQuery.each(this.components.limits,function(i,sliderLimitLabel){sliderLimitLabel.destroy()}),this.components.value.remove(),this.$el.remove()},Slider.POINTER_FROM=0,Slider.POINTER_TO=1,Slider.CLASSNAME="jslider",Slider.SELECTOR=".jslider-",Slider}();jQuery.slider=function(node,settings,force){"undefined"==typeof force&&(force=!1);var jNode=jQuery(node);return jNode.data("jslider")||jNode.data("jslider",new Slider(node,settings)),jNode.data("jslider")},jQuery.fn.slider=function(action,optValue){function isDef(val){return void 0!==val}function isDefAndNotNull(val){return null!=val}var returnValue,args=arguments;return this.each(function(){var self=jQuery.slider(this,action,optValue);if("string"==typeof action)switch(action){case"value":if(isDef(args[1])&&isDef(args[2])){var pointers=self.getPointers();isDefAndNotNull(pointers[0])&&isDefAndNotNull(args[1])&&(pointers[0].set(args[1]),pointers[0].setIndexOver()),isDefAndNotNull(pointers[1])&&isDefAndNotNull(args[2])&&(pointers[1].set(args[2]),pointers[1].setIndexOver())}else if(isDef(args[1])){var pointers=self.getPointers();isDefAndNotNull(pointers[0])&&isDefAndNotNull(args[1])&&(pointers[0].set(args[1]),pointers[0].setIndexOver())}else returnValue=self.getValue();break;case"prc":if(isDef(args[1])&&isDef(args[2])){var pointers=self.getPointers();isDefAndNotNull(pointers[0])&&isDefAndNotNull(args[1])&&(pointers[0]._set(args[1]),pointers[0].setIndexOver()),isDefAndNotNull(pointers[1])&&isDefAndNotNull(args[2])&&(pointers[1]._set(args[2]),pointers[1].setIndexOver())}else if(isDef(args[1])){var pointers=self.getPointers();isDefAndNotNull(pointers[0])&&isDefAndNotNull(args[1])&&(pointers[0]._set(args[1]),pointers[0].setIndexOver())}else returnValue=self.getPrcValue();break;case"calculatedValue":var value=self.getValue().split(";");returnValue="";for(var i=0;i<value.length;i++)returnValue+=(i>0?";":"")+self.nice(value[i]);break;case"disable":self.disableSlider();break;case"enable":self.enableSlider();break;case"skin":self.setSkin(args[1])}else action||optValue||(jQuery.isArray(returnValue)||(returnValue=[]),returnValue.push(self))}),jQuery.isArray(returnValue)&&1==returnValue.length&&(returnValue=returnValue[0]),returnValue||this};